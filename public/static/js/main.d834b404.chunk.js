(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{18:function(e,n,t){},19:function(e,n,t){},28:function(e,n,t){},29:function(e,n,t){},31:function(e,n,t){},32:function(e,n,t){},33:function(e,n,t){},34:function(e,n,t){},36:function(e,n,t){},37:function(e,n,t){},43:function(e,n,t){},44:function(e,n,t){"use strict";t.r(n);var a=t(1),c=t.n(a),i=t(21),r=t.n(i),o=(t(28),t(4)),s=t(11),l=t(2),d=t(9),j=t(10),u=(t(29),c.a.createContext({token:null,userId:null,isAdmin:null,login:function(e,n,t,a){},logout:function(){}})),m=t(0),h=function(){var e=Object(a.useState)(!0),n=Object(o.a)(e,2),t=n[0],c=n[1],i=Object(a.useState)(!1),r=Object(o.a)(i,2),s=(r[0],r[1]),l=Object(a.useState)({email:"",password:""}),h=Object(o.a)(l,2),b=h[0],O=h[1],x=Object(a.useContext)(u),f=function(e){var n=e.target,t=n.name,a=n.value;O(Object(j.a)(Object(j.a)({},b),{},Object(d.a)({},t,a)))};return Object(m.jsx)("div",{className:"container",children:Object(m.jsx)("div",{className:"log-form",children:Object(m.jsxs)("form",{className:"col-md-6 offset-md-3",onSubmit:function(e){e.preventDefault();var n=b.email,a=b.password,c={query:'\n        query{\n          login(email :"'.concat(n,'" , password :"').concat(a,'"){\n            userId \n            token\n            tokenExpiration\n           isAdmin\n            \n          }\n        }\n      ')};t||(c={query:"\n          mutation CreateUser($email:String!, $password:String!){ \n            createUser(userInput: {email :$email , password:$password }){\n              _id\n              email\n            }\n          }\n        ",variables:{email:n,password:a}}),fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed");return e.json()})).then((function(e){e.data.login.token&&x.login(e.data.login.token,e.data.login.userId,e.data.login.tokenExpiration,e.data.login.isAdmin)})).catch((function(e){console.log(e),s(!0)}))},children:[Object(m.jsx)("h2",{children:t?"Please  Sign In":"Please Sign Up"}),Object(m.jsx)("hr",{className:"divisor"}),Object(m.jsx)("div",{className:"form-control",children:Object(m.jsx)("input",{type:"email",id:"email",name:"email",placeholder:"email",value:b.email,onChange:f})}),Object(m.jsx)("div",{className:"form-control",children:Object(m.jsx)("input",{type:"password",id:"password",name:"password",placeholder:"password",value:b.password,onChange:f})}),Object(m.jsxs)("div",{className:"form-actions",children:[Object(m.jsxs)("button",{type:"button",className:"btn",onClick:function(){c(!t)},children:["Switch to ",t?"Signup":"Login"]}),Object(m.jsx)("button",{type:"submit",className:"btn",children:"Submit"})]})]})})})},b=(t(31),function(e){return Object(m.jsxs)("div",{className:"modal",children:[Object(m.jsx)("header",{className:"modal__header",children:Object(m.jsxs)("h1",{children:[" ",e.title," "]})}),Object(m.jsxs)("section",{className:"modal__content",children:[" ",e.children]}),Object(m.jsxs)("section",{className:"modal__actions",children:[e.canCancel&&Object(m.jsx)("button",{className:"btn",onClick:e.onCancel,children:"Cancel"}),e.canConfirm&&Object(m.jsx)("button",{className:"btn",onClick:e.onConfirm,children:e.buttonTitle})]})]})}),O=(t(32),function(e){return Object(m.jsx)("div",{className:"backdrop"})}),x=(t(33),t(18),t(19),void 0),f=function(e){return Object(m.jsx)("li",{children:Object(m.jsxs)("div",{className:"card",children:[Object(m.jsx)("input",{type:"checkbox",className:"input"}),Object(m.jsx)("div",{className:"toggle",children:"+"}),Object(m.jsx)("div",{className:"imgBx",children:Object(m.jsx)("img",{id:"img",src:e.urlImage,alt:e.clasa})}),Object(m.jsxs)("div",{className:"content",children:[Object(m.jsx)("h1",{children:e.marca}),Object(m.jsxs)("h2",{children:["Clasa : ",e.clasa]}),Object(m.jsxs)("h2",{children:["Numar Kilometri : ",e.numarKilometri," km"]}),Object(m.jsxs)("h2",{children:["Price/hour: $",e.price]}),Object(m.jsxs)("h2",{children:["Marca : ",e.marca]}),Object(m.jsxs)("h2",{children:["Clasa: ",e.clasa," "]}),Object(m.jsxs)("h2",{children:["Date: ",new Date(e.date).toDateString()," "]}),Object(m.jsxs)("div",{className:"buttonsContainer",children:[Object(m.jsx)("button",{className:"btnn",onClick:e.onDetail.bind(x,e.eventId),children:"View Details"}),e.isAdmin&&Object(m.jsx)("button",{className:"btnn",onClick:e.onDelete.bind(x,e.eventId),children:"Delete"})]})]})]})},e.eventId)},p=function(e){var n=e.events.map((function(n){return Object(m.jsx)(f,{className:"event__item",eventId:n._id,marca:n.marca,clasa:n.clasa,numarKilometri:n.numarKilometri,price:n.price,date:n.date,urlImage:n.urlImage,creatorId:n.creator._id,userId:e.authUserId,onDetail:e.onViewDetail,onDelete:e.onDelete,isAdmin:e.isAdmin},n._id)}));return Object(m.jsx)("ul",{className:"event__list",children:n})},g=(t(34),function(){return Object(m.jsx)("div",{className:"spinner",children:Object(m.jsx)("div",{className:"lds-dual-ring"})})}),v=function(){var e=Object(a.useState)(!1),n=Object(o.a)(e,2),t=n[0],i=n[1],r=Object(a.useState)(),s=Object(o.a)(r,2),l=s[0],h=s[1],x=Object(a.useState)([]),f=Object(o.a)(x,2),v=f[0],k=f[1],C=Object(a.useState)(!1),N=Object(o.a)(C,2),y=N[0],I=N[1],_=Object(a.useState)({numarInmatriculare:"",numarKilometri:"",date:"",marca:"",detaliiMarca:"",clasa:"",price:"",urlImage:"",description:""}),w=Object(o.a)(_,2),S=w[0],A=w[1],D=Object(a.useContext)(u),F=function(e){var n=e.target,t=n.name,a=n.value;A(Object(j.a)(Object(j.a)({},S),{},Object(d.a)({},t,a)))},T=function(){i(!1),h(null)};Object(a.useEffect)((function(){q()}),[]);var q=function(){I(!0);D.token;fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify({query:"\n      query { \n        events{\n          _id\n          date,\n          description,\n          numarInmatriculare,\n          numarKilometri,\n          marca,\n          detaliiMarca,\n          clasa,\n          price,\n          urlImage,\n          creator{\n            _id\n            email\n          }\n        }\n      }\n    "}),headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed");return e.json()})).then((function(e){var n=e.data.events;k(n),I(!1)})).catch((function(e){console.log(e),I(!1)}))};return Object(m.jsxs)(c.a.Fragment,{children:[(t||l)&&Object(m.jsx)(O,{}),t&&Object(m.jsx)(b,{buttonTitle:"Confirm",title:"Add Car",canCancel:!0,canConfirm:!0,onCancel:T,onConfirm:function(){i(!1);var e=S.numarInmatriculare,n=S.numarKilometri,t=S.date,a=S.marca,c=S.detaliiMarca,r=S.clasa,o=S.price,s=S.urlImage,l=S.description,d={query:'\n        mutation { \n          createEvent(eventInput: {\n            numarInmatriculare:"'.concat(e,'" ,\n            numarKilometri:"').concat(n,'" ,\n            marca:"').concat(a,'", \n            detaliiMarca:"').concat(c,'", \n            clasa:"').concat(r,'", \n            price:"').concat(o,'", \n            urlImage:"').concat(s,'", \n            date:"').concat(t,'"\n            description:"').concat(l,'"\n            })\n          {\n            _id\n            date,\n            description,\n            numarInmatriculare,\n            numarKilometri,\n            marca,\n            detaliiMarca,\n            clasa,\n            price,\n            urlImage,\n            creator{\n              _id\n              email\n            }\n          }\n        }\n      ')},j=D.token;fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json",Authorization:"Bearer "+j}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed");return e.json()})).then((function(e){q()})).catch((function(e){console.log(e)}))},children:Object(m.jsxs)("form",{children:[Object(m.jsxs)("div",{className:"form-control",children:[Object(m.jsx)("label",{htmlFor:"numarInmatriculare",children:"Numar Inmatriculare"}),Object(m.jsx)("input",{type:"text",id:"numarInmatriculare",name:"numarInmatriculare",value:S.numarInmatriculare,onChange:F})]}),Object(m.jsxs)("div",{className:"form-control",children:[Object(m.jsx)("label",{htmlFor:"numarKilometri",children:"Numar kilometri"}),Object(m.jsx)("input",{type:"number",id:"numarKilometri",name:"numarKilometri",value:S.numarKilometri,onChange:F})]}),Object(m.jsxs)("div",{className:"form-control",children:[Object(m.jsx)("label",{htmlFor:"date",children:"Data Fabricatie"}),Object(m.jsx)("input",{type:"datetime-local",id:"date",name:"date",value:S.date,onChange:F})]}),Object(m.jsxs)("div",{className:"form-control",children:[Object(m.jsx)("label",{htmlFor:"marca",children:"Marca"}),Object(m.jsx)("input",{type:"text",id:"marca",name:"marca",value:S.marca,onChange:F})]}),Object(m.jsxs)("div",{className:"form-control",children:[Object(m.jsx)("label",{htmlFor:"detaliiMarca",children:"Detalii Marca"}),Object(m.jsx)("input",{type:"text",id:"detaliiMarca",name:"detaliiMarca",value:S.detaliiMarca,onChange:F})]}),Object(m.jsxs)("div",{className:"form-control",children:[Object(m.jsx)("label",{htmlFor:"clasa",children:"Clasa"}),Object(m.jsx)("input",{type:"text",id:"clasa",name:"clasa",value:S.clasa,onChange:F})]}),Object(m.jsxs)("div",{className:"form-control",children:[Object(m.jsx)("label",{htmlFor:"price",children:"Pret/ora"}),Object(m.jsx)("input",{type:"number",id:"price",name:"price",value:S.price,onChange:F})]}),Object(m.jsxs)("div",{className:"form-control",children:[Object(m.jsx)("label",{htmlFor:"urlImage",children:"Url-Image"}),Object(m.jsx)("input",{type:"text",id:"urlImage",name:"urlImage",value:S.urlImage,onChange:F})]}),Object(m.jsxs)("div",{className:"form-control",children:[Object(m.jsx)("label",{htmlFor:"description",children:"Description"}),Object(m.jsx)("textarea",{type:"text",id:"description",rows:"4",name:"description",value:S.description,onChange:F})]})]})}),l&&Object(m.jsx)(b,{buttonTitle:D.token?"Book":"Confirm",title:l.marca,canCancel:!0,canConfirm:!0,onCancel:T,onConfirm:function(){if(D.token){var e={query:'\n      mutation { \n        bookEvent(eventId : "'.concat(l._id,'"){\n          _id\n          createdAt\n          updatedAt\n        }\n      }\n    ')},n=D.token;fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed");return e.json()})).then((function(e){console.log(e),h(null)})).catch((function(e){console.log(e),I(!1)}))}else h(null)},children:Object(m.jsxs)("div",{children:[Object(m.jsxs)("h1",{children:["Marca :",l.marca]}),Object(m.jsxs)("h2",{children:["Clasa : ",l.clasa]}),Object(m.jsxs)("h2",{children:["Numar Inmatriculare : ",l.numarInmatriculare]}),Object(m.jsxs)("h2",{children:["Detalii Marca : ",l.detaliiMarca]}),Object(m.jsxs)("h2",{children:["Numar Kilometri : ",l.numarKilometri," km"]}),Object(m.jsxs)("h2",{children:["Data fabricatie:",Object(m.jsx)("i",{children:new Date(l.date).toDateString()})," "]}),Object(m.jsxs)("h2",{children:["Price/hour: $",l.price," /h"]}),Object(m.jsxs)("h2",{children:["description : ",l.description]})]})}),"true"===D.isAdmin&&D.token?Object(m.jsxs)("div",{className:"events-controls",children:[Object(m.jsx)("p",{children:"Share new cars!!"}),Object(m.jsx)("button",{className:"btn",onClick:function(){i(!0)},children:"Add a new car"})]}):Object(m.jsx)("div",{}),y?Object(m.jsx)(g,{}):Object(m.jsx)(p,{events:v,authUserId:D.userId,onViewDetail:function(e){h((function(){var n=v.find((function(n){return n._id===e}));return h(n)}))},onDelete:function(e){console.log(e);var n={query:'\n      mutation { \n        deleteEvent(eventId : "'.concat(e,'"){\n          _id\n        }\n      }\n    ')},t=D.token;fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed");return e.json()})).then((function(e){console.log(e),q()})).catch((function(e){console.log(e),I(!1)}))},isAdmin:D.isAdmin})]})},k=t(15),C=t.n(k),N=t(22),y=(t(36),void 0),I=function(e){return Object(m.jsx)("ul",{className:"bookings__list",children:e.bookings.map((function(n){return Object(m.jsx)("li",{className:"events__list-item",children:Object(m.jsxs)("div",{className:"sp",children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:n.event.marca}),Object(m.jsxs)("h2",{children:["Clasa : ",n.event.clasa]}),Object(m.jsxs)("h2",{children:["Numar Kilometri : ",n.event.numarKilometri," km"]}),Object(m.jsxs)("h2",{children:["Price/hour: $",n.event.price,"/h"]}),Object(m.jsxs)("h2",{children:["Booking started date :",Object(m.jsxs)("i",{children:[" ",new Date(n.createdAt).toLocaleDateString()]})]})]}),Object(m.jsxs)("div",{className:"booking__item-actions",children:[Object(m.jsx)("button",{className:"btn",onClick:e.onDelete.bind(y,n._id),children:"Cancel"}),Object(m.jsx)("button",{className:"btn",onClick:e.onConfirm.bind(y,n._id),children:"Confirm"})]})]})},n._id)}))})},_=function(){var e=Object(a.useState)([]),n=Object(o.a)(e,2),t=n[0],i=n[1],r=Object(a.useState)(!1),s=Object(o.a)(r,2),l=s[0],d=s[1],j=Object(a.useState)(!1),h=Object(o.a)(j,2),x=h[0],f=h[1],p=Object(a.useState)(),v=Object(o.a)(p,2),k=v[0],y=v[1],_=Object(a.useState)(),w=Object(o.a)(_,2),S=w[0],A=w[1],D=Object(a.useContext)(u);Object(a.useEffect)((function(){F()}),[]),console.log(t);var F=function(){d(!0);var e=D.token;fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify({query:"\n      query { \n        bookings{\n          _id\n          createdAt\n          user{\n            _id\n          }\n          event{\n              _id\n              date,\n              description,\n              numarInmatriculare,\n              numarKilometri,\n              marca,\n              detaliiMarca,\n              clasa,\n              price,\n              urlImage,\n          }\n        }\n      }\n    "}),headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed");return e.json()})).then((function(e){var n=e.data.bookings;i(n),d(!1)})).catch((function(e){console.log(e),d(!1)}))};console.log(k);var T=function(){var e={query:'\n    mutation { \n      addToBlackList(userId : "'.concat(S,'"){\n        _id\n      }\n    }\n  ')},n=D.token;fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed");return e.json()})).then((function(e){console.log(e),B(k)})).catch((function(e){console.log(e),d(!1)}))},q=function(){var e=Object(N.a)(C.a.mark((function e(n){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!0),console.log(k),T(),f(!1);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),B=function(e){f(!1),d(!0);var n={query:"\n      mutation CancelBooking($id : ID!) { \n        cancelBooking(bookingId :$id){\n          _id\n          numarInmatriculare\n        }\n      }\n    ",variables:{id:e}},a=D.token;fetch("http://localhost:8000/graphql",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer "+a}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed");return e.json()})).then((function(n){d(!0);var a=t.filter((function(n){return n._id!==e}));i(a),d(!1)})).catch((function(e){console.log(e),d(!1)}))};return Object(m.jsxs)(c.a.Fragment,{children:[x&&Object(m.jsx)(O,{}),x&&k&&Object(m.jsx)(b,{buttonTitle:"Add to Black List",title:"Add to Black List",canCancel:!0,canConfirm:!0,onCancel:function(){return B(k)},onConfirm:function(){return q(k._id)},children:Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"Confirm Booking"}),Object(m.jsx)("h2",{children:"Do you want to add this user to Black List?"})]})}),l?Object(m.jsx)(g,{}):Object(m.jsx)(I,{bookings:t,onDelete:B,onConfirm:function(e){f(!0);var n=t.filter((function(n){return n._id===e}));y(n[0]._id),A(n[0].user._id)}})]})},w=(t(37),function(e){var n=Object(a.useContext)(u);return Object(m.jsxs)("header",{className:"main-navigation",children:[Object(m.jsx)("div",{className:"main-navigation__logo",children:Object(m.jsx)("h1",{children:"Booking"})}),Object(m.jsx)("div",{className:"main-navigation__items",children:Object(m.jsxs)("ul",{children:[Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/cars",children:"Cars"})}),!n.token&&Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/auth",children:"Authenticate"})}),n.token&&Object(m.jsxs)(c.a.Fragment,{children:[Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/bookings",children:"Bookings"})}),Object(m.jsx)("li",{children:Object(m.jsx)("button",{onClick:n.logout,children:" Logout"})})]})]})})]})});t(43);var S=function(){var e=Object(a.useState)({token:null,userId:null,isAdmin:null}),n=Object(o.a)(e,2),t=n[0],i=n[1];return console.log(t),Object(m.jsx)(s.a,{children:Object(m.jsx)(c.a.Fragment,{children:Object(m.jsxs)(u.Provider,{value:{token:t.token,userId:t.userId,isAdmin:t.isAdmin,login:function(e,n,t,a){i({token:e,userId:n,isAdmin:a})},logout:function(){i({token:null,userId:null,isAdmin:null})}},children:[Object(m.jsx)(w,{}),Object(m.jsx)("main",{className:"main-content",children:Object(m.jsxs)(l.d,{children:[t.token&&Object(m.jsx)(l.a,{from:"/",to:"/cars",exact:!0}),t.token&&Object(m.jsx)(l.a,{from:"/auth",to:"/cars",exact:!0}),!t.token&&Object(m.jsx)(l.b,{path:"/auth",component:h,exact:!0}),Object(m.jsx)(l.b,{path:"/cars",component:v,exact:!0}),!t.token&&Object(m.jsx)(l.a,{to:"/auth",exact:!0}),t.token&&Object(m.jsx)(l.b,{path:"/bookings",component:_,exact:!0})]})})]})})})};r.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(S,{})}),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.d834b404.chunk.js.map